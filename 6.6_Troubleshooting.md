# 6.6 Troubleshooting

# Задание №1

Пользователь (разработчик) написал в канал поддержки, что у него уже 3 минуты происходит CRUD операция в MongoDB и её нужно прервать.

Вы как инженер поддержки решили произвести данную операцию:

   - напишите список операций, которые вы будете производить для остановки запроса пользователя
   
   Нам нужно найти процесс opid и затем завершить его:
   ```
   db.currentOp({
     "active" : true,
     "secs_running" : { "$gt" : 180 },
     })
     
   Далее получаем ответ, в котором ищем "opid" : 1111.
   Используя операцию db.killOP(1111), завершаем зависший процесс.
   ```
   - предложите вариант решения проблемы с долгими (зависающими) запросами в MongoDB

   ```
   Можно использовать  public MongoCursor::maxTimeMS ( int $ms ) : MongoCursor - $ms - время в секундах, при котором сервер    
   MongoDB прерывает длительные запросы. 
   ```
   
# Задание №2

Вы запустили инстанс Redis для использования совместно с сервисом, который использует механизм TTL. Причем отношение количества записанных key-value значений к количеству истёкших значений есть величина постоянная и увеличивается пропорционально количеству реплик сервиса.

При масштабировании сервиса до N реплик вы увидели, что:

  - сначала рост отношения записанных значений к истекшим
  - Redis блокирует операции записи

Как вы думаете, в чем может быть проблема?











